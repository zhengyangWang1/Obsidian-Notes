---
title: 操作系统
categories:
  - Notes
  - 课程
  - 操作系统
update: 
tags:
  - 操作系统
---
老师声音小，需要坐前排

40分平时作业（gitee），60分期末

TODO：
- [x] 加入gitee仓库



---

虚拟换CPU：
操作系统需要以某种方式在看似同时运行的许多程序之间共享物理CPU 基本思想：运行一个程序一小会儿，然后切换到运行另一个程序，依此类推 分时CPU - 虚拟化就实现了！

都具有用于在内存和寄存器之间移动项目的加载和存储指令 
- 将位于内存中某个地址的字加载到寄存器中 
- 将寄存器的内容存储到位于内存中某个地址的字 
- 许多用于比较和的指令组合寄存器中的值并将结果放入寄存器

CPU的结构：
- 程序计数器（Program Counter，PC）：保存下一条指令的内存地址
- 指令寄存器（Instruction Register，IR）：保存当前正在执行的指令
- 通用寄存器（General Registers，R1...Rn）：保存执行环境：临时结果
- 算术逻辑单元（Arithmetic Logic Unit，ALU）：执行算术函数和逻辑运行
- 堆栈指针（The Stack Pointer，SP）：保存堆栈的内存地址，以及每个活动函数的参数和局部变量的帧（frame）
- 程序状态字（The Program Status Word，PSW）：包含一些重要的控制位

CPU 所做的就是获取/解码/执行获取 PC 指向的下一条指令，对其进行解码以查找其类型，然后操作数重复执行它

寄存器r15指向执行栈的顶部
堆栈从较高的内存地址向较低的内存地址向下增长

CPU在PSW中有一个模式位，用于定义程序的执行能力

内核模式：执行任何指令
用户模式： 执行指令的子集
仅在内核模式下执行的指令称为特权指令

在用户模式下运行的应用程序要执行系统调用，用户程序需要执行一条称为陷阱`trap`的指令
它所做的只是跳转到内核，同时将特权级别提升到内核模式
我们需要返回到进行系统调用的程序，但同时，需要清除模式位（将特权级别降低回用户模式）同样，操作系统依赖于CPU的一些帮助，通过使用另一条指令，我们称之为从陷阱返回`return-from-trap`

内核在内核模式下启动时会设置一个陷阱表，然后让硬件知道它在哪里。陷阱表也称为中断表/向量，因为它也有硬件中断和异常的条目！事实证明，trap 只是陷阱表中的条目之一。系统调用的实际类型称为系统调用号，它可以存储在内核堆栈中的众所周知的位置