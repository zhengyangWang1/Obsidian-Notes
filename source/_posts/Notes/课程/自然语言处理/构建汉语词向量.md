---
title: 构建汉语词向量
categories:
  - Notes
  - 课程
  - 自然语言处理
date:
tags:
---

### 代码逻辑
首先对训练数据和测试数据进行处理，按词进行分割然后储存起来，然后通过SVG和SGNS方法计算出训练数据的词向量，再在测试数据上进行测试。
为此，在代码中定义了`load_data()`, `caculate_sim()`, `svd_embedding()`和`sgns_embedding()`四个方法，分别进行数据处理、计算测试集上向量相关性、通过svd和sgns得到训练集上向量的操作。
最后对输出结果，按要求写入文本文件中。
### SVG
```python
def svd_embedding(train_data, test_data, dim):
    model = Word2Vec(train_data, vector_size=dim, window=2, sg=0)
    vectors = model.wv.vectors
    svd = TruncatedSVD(n_components=5)  # K=5
    vec_svd = svd.fit_transform(vectors)  # 将词向量降维
    word_index = model.wv.key_to_index
    svd_result = caculate_sim(test_data, vec_svd, word_index)
    
    return vec_svd, svd_result
```

在SVD中，非零奇异值的数量即为原始矩阵的秩，通常来说，非零奇异值的数量等于词汇表的大小，代码中**key_to_index*的长度即为非零

### SGNS